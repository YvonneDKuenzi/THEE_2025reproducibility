plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 6))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 1))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 6))
# let's try another transmission function.
plot(x=temp_x, y=(1-exp(-5*temp_x))
# let's try another transmission function.
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-0.5*temp_x)))
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-50*temp_x)))
plot(x=temp_x, y=(1-exp(-0.5*temp_x)))
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-50*temp_x)))
phase_diag(c(infect=0.1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
ggplot(sim_forward_time(time=1:100,
init = 0.2,
params = c(infect=0.01, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=group, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.01, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=group, colour=group)) +
geom_point()
sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.01, shed=0.5, D50=1, recov=0.1))
sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1))
sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1))
sim_forward_time(time=1:100,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1))
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=group, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:10,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=group, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:10,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.1)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:10,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=1)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:10,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:2,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyr)
#library(purrr)
library(dplyr)
library(deSolve)
library(phaseR)
#library(patchwork)
#library(kableExtra)
#library(shiny)
#library(bslib) # for most recent recommended UI options
# set the default plot style
fave_theme <- theme_light() + # see other options at https://ggplot2.tidyverse.org/reference/ggtheme.html
theme(text = element_text(size=18), # larger text size for titles & axes
panel.grid.major = element_blank(), # remove major gridlines
panel.grid.minor = element_blank()) # remove minor gridlines
theme_set(fave_theme)
# increase the default thickness of lines for all geom objects in ggplot2
update_geom_defaults("line", list(linewidth = 2.5, alpha=0.8))
# define tree and grass colours
colours_SI = c(Susceptible = "#440154FF", Infected = "#ffbf00")
colour_water <- "#21908CFF"
# Chunk 2
# # ordinary differential equation: a function to get the rate of change over time
#   ## We keep beta as a parameter just in case we want to play with it later
# ODE <- function(time, init, params){
#   with (as.list(c(time, init, params)), {
#     # define the differential equations:
#     dI_dt = infect*(1-I)*(shed*I/(shed*I + D50)) - recov*I
#     return(list(dI = dI_dt))
#   })
# }
ODE <- function(time, init, params) {
with (as.list(c(time, init, params)), {
# define the differential equations:
dy_dt = infect*(1-y)*(shed*y/(shed*y + D50)) - recov*y
return(list(c(dy = dy_dt)))
})
}
# let's plot the transmission function
temp_x <- (1:100)/100
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 1))
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 6))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 1))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 6))
# this one isn't really sigmoid shaped...
# let's try another transmission function.
plot(x=temp_x, y=(1-exp(-0.5*temp_x)))
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-50*temp_x)))
# a function to simulate the community over time
sim_forward_time <- function(time, init, params) {
# solve the system of ODE's for the requested time points:
sim <- ode(func = ODE, y = init, parms = params, times = time, method="ode23")
# make a long data.frame with Infected and Susceptible over time
return(data.frame(time = rep(sim[,1], times=2),
group = rep(c("infected", "susceptible"), each=length(time)),
# recall that susceptible = 1 - infected
density = c(sim[,2], 1-sim[,2]))
)
}
# a function to print phase portrait
phase_diag <- function(params)
phasePortrait(deriv = ODE,
parameters = params,
ylim   = c(0, 1),
points = 10, frac = 0.5) # graphing parameters
# bistable:
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
ggplot(sim_forward_time(time=1:2,
init = c(y=0.2, x=0.8),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyr)
#library(purrr)
library(dplyr)
library(deSolve)
library(phaseR)
#library(patchwork)
#library(kableExtra)
#library(shiny)
#library(bslib) # for most recent recommended UI options
# set the default plot style
fave_theme <- theme_light() + # see other options at https://ggplot2.tidyverse.org/reference/ggtheme.html
theme(text = element_text(size=18), # larger text size for titles & axes
panel.grid.major = element_blank(), # remove major gridlines
panel.grid.minor = element_blank()) # remove minor gridlines
theme_set(fave_theme)
# increase the default thickness of lines for all geom objects in ggplot2
update_geom_defaults("line", list(linewidth = 2.5, alpha=0.8))
# define tree and grass colours
colours_SI = c(Susceptible = "#440154FF", Infected = "#ffbf00")
colour_water <- "#21908CFF"
# Chunk 2
# # ordinary differential equation: a function to get the rate of change over time
#   ## We keep beta as a parameter just in case we want to play with it later
# ODE <- function(time, init, params){
#   with (as.list(c(time, init, params)), {
#     # define the differential equations:
#     dI_dt = infect*(1-I)*(shed*I/(shed*I + D50)) - recov*I
#     return(list(dI = dI_dt))
#   })
# }
ODE <- function(time, init, params) {
with (as.list(c(time, init, params)), {
# define the differential equations:
dy_dt = infect*(1-y)*(shed*y/(shed*y + D50)) - recov*y
return(list(c(dy = dy_dt)))
})
}
# let's plot the transmission function
temp_x <- (1:100)/100
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 1))
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 6))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 1))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 6))
# this one isn't really sigmoid shaped...
# let's try another transmission function.
plot(x=temp_x, y=(1-exp(-0.5*temp_x)))
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-50*temp_x)))
# a function to simulate the community over time
sim_forward_time <- function(time, init, params) {
# solve the system of ODE's for the requested time points:
sim <- ode(func = ODE, y = init, parms = params, times = time, method="ode23")
# make a long data.frame with Infected and Susceptible over time
return(data.frame(time = rep(sim[,1], times=2),
group = rep(c("infected", "susceptible"), each=length(time)),
# recall that susceptible = 1 - infected
density = c(sim[,2], 1-sim[,2]))
)
}
# a function to print phase portrait
phase_diag <- function(params)
phasePortrait(deriv = ODE,
parameters = params,
ylim   = c(0, 1),
points = 10, frac = 0.5) # graphing parameters
# bistable:
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
ggplot(sim_forward_time(time=1:2,
init = c(y=0.2),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.03, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.3, shed=0.5, D50=1, recov=0.7)),
aes(x=time, y=density, colour=group)) +
geom_point()
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.9, shed=0.5, D50=1, recov=0.3)),
aes(x=time, y=density, colour=group)) +
geom_point()
temp_x <- (1:100)/100
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 1))
plot(x=temp_x, y=(5 * temp_x)/(5 * temp_x + 6))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 1))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 6))
plot(x=temp_x, y=(500 * temp_x)/(500 * temp_x + 10))
ggplot(sim_forward_time(time=1:100,
init = c(y=0.2),
params = c(infect=0.9, shed=500, D50=10, recov=0.3)),
aes(x=time, y=density, colour=group)) +
geom_point()
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=1, shed=0.5, D50=1, recov=0.1))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.1))
# infection-free
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.2))
phase_diag(c(infect=0.01, shed=0.5, D50=1, recov=0.02))
phase_diag(c(infect=0.01, shed=0.5, D50=10, recov=0.02))
phase_diag(c(infect=0.01, shed=5, D50=1, recov=0.02))
phase_diag(c(infect=0.01, shed=0.05, D50=1, recov=0.02))
phase_diag(c(infect=0.01, shed=0.05, D50=10, recov=0.02))
phase_diag(c(infect=0.01, shed=0.05, D50=100, recov=0.02))
phase_diag(c(infect=0.01, shed=0.05, D50=10000, recov=0.02))
phase_diag(c(infect=0.01, shed=5, D50=10000, recov=0.02))
plot(x=temp_x, y=(1-exp(-0.5*temp_x)))
plot(x=temp_x, y=(1-exp(-5*temp_x)))
plot(x=temp_x, y=(1-exp(-10*temp_x)))
plot(x=temp_x, y=(1-exp(-50*temp_x)))
hilldose <- function(x, params)
1/(1 + exp((params["D50"] - x) * params["shed"]))
hilldos(x=temp_x, params=c(infect=0.9, shed=500, D50=10, recov=0.3))
hilldose(x=temp_x, params=c(infect=0.9, shed=500, D50=10, recov=0.3))
hilldose(x=temp_x, params=c(infect=0.9, shed=5, D50=1, recov=0.3))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=5, D50=1, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=5, D50=0.2, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=5, D50=0.5, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=0.7, D50=0.5, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=7, D50=0.5, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=9, D50=0.5, recov=0.3)))
plot(x=temp_x, y= hilldose(x=temp_x, params=c(infect=0.9, shed=10, D50=0.5, recov=0.3)))
?beta
?b
?nbt
?bt
?bta
?gamma
?sigma
?rho
ODE <- function(time, init, params) {
with (as.list(c(time, init, params)), {
# define the differential equations:
# y is the number of infected individuals
dy_dt = b * (1-y)*x - g * y
# x is the parasite density in the environmental reservoir
dx_dt = s * y - r * x
return(list(c(dx = dx_dt, dy = dy_dt)))
})
}
test <- ode(func = ODE, init = c(x=0, y=0.1), parms = c(b = 0.3, g = 0.2, s = 0.1, r = 0.07), times = 1:100, method="ode23")
ODE <- function(time, init, params) {
with (as.list(c(time, init, params)), {
# define the differential equations:
# y is the number of infected individuals
dy_dt = b * (1-y)*x - g * y
# x is the parasite density in the environmental reservoir
dx_dt = s * y - r * x
return(list(c(dx = dx_dt, dy = dy_dt)))
})
}
test <- ode(func = ODE, init = c(x=0, y=0.1), parms = c(b = 0.3, g = 0.2, s = 0.1, r = 0.07), times = 1:100, method="ode23")
ode
?ode
test <- ode(func = ODE, y = c(x=0, y=0.1), parms = c(b = 0.3, g = 0.2, s = 0.1, r = 0.07), times = 1:100, method="ode23")
test
test <- ode(func = ODE, y = c(x=0, y=0.1), parms = c(b = 0.2, g = 0.3, s = 0.1, r = 0.07), times = 1:100, method="ode23")
test
plot(x=test$x, y=test$y)
str(test)
tets
test$x
plot(x=test["x"], y=test$y)
plot(x=test["x"], y=test["y"])
test["y"]
test["x"]
str(tets)
str(test)
test$x
test[,"x"]
plot(x=test[,"x"], y=test[,"y"])
?rbin
?dbinom
rbinom(10, size=1, prob=0.5)
SOS_fun <- function(c, m) m*c + 0.1 - m*50/2
SOS_fun(0:50,0)
SOS_fun(0:50,1)
SOS_fun(0:50,2/50)
2/50
dgamma(1:50)
dgamma(1:100, shape=0.000001, rate=1/0.000001)
dgamma((0:100)/100, shape=0.000001, rate=1/0.000001)
dgamma((0:100)/100, shape=0.0001, rate=1/0.0001)
dgamma((0:100)/100, shape=0.01, rate=1/0.01)
dgamma((0:100)/100, shape=0.01, rate=2/0.01)
dgamma((0:100)/100, shape=0.1, rate=2/0.1)
dgamma((0:100)/100, shape=0.01, rate=2/0.01)
x <- (0:100)/100
x <- x[2:100]
x
y <- dgamma((0:100)/100, shape=0.1, rate=2/0.1)
y <- y[2:100]
y
plot(x,y)
y <- dgamma((0:100)/100, shape=0.5, rate=2/0.5)
y <- y[2:100]
plot(x,y)
y <- dgamma((0:100)/100, shape=0.9, rate=2/0.9)
plot(x,y)
y <- y[2:100]
plot(x,y)
y2 <- dgamma((0:100)/100, shape=9, rate=2/9)
y2 <- y2[2:100]
plot(x,y2)
y <- dgamma((0:100)/100, shape=0.9, rate=0.5/0.9)
y <- y[2:100]
plot(x,y)
y2 <- dgamma((0:100)/100, shape=9, rate=0.5/9)
y2 <- y2[2:100]
plot(x,y2)
y2 <- dgamma((0:100)/100, shape=2, rate=0.5/2)
y2 <- y2[2:100]
plot(x,y2)
y2 <- dgamma((0:100)/100, shape=9, rate=0.1/9)
y2 <- y2[2:100]
plot(x,y2)
y2 <- dgamma((0:100)/100, shape=9, rate=0.01/9)
y2 <- y2[2:100]
plot(x,y2)
y2 <- dgamma((0:200)/100, shape=9, rate=0.01/9)
y2 <- y2[2:200]
x2 <- (0:200)/100
x2 <- x2[2:200]
plot(x2, y2)
plot(1:20, dgamma(1:20, shape=9, rate=0.01/9))
plot(1:200, dgamma(1:200, shape=9, rate=0.01/9))
?dgamma
plot(1:200, dgamma(1:200, shape=9, scale =0.01/9))
plot(1:10, dgamma(1:200, shape=9, scale =0.01/9))
plot(1:10, dgamma(1:10, shape=9, scale =0.01/9))
plot(1:10, dgamma(1:10, shape=9, scale =0.5/9))
x <- (1:100)/100
plot(x, dgamma(x, shape=0.9, scale=2/0.9))
plot(x, dgamma(x, shape=9, scale=2/9))
plot(x, dgamma(x, shape=9, scale=1/9))
plot(x, dgamma(x, shape=9, scale=0.5/9))
plot(x, dgamma(x, shape=90, scale=0.5/90))
plot(x, dgamma(x, shape=90, scale=0.7/90))
plot(x, dgamma(x, shape=90, scale=0.7/90), pch="l")
plot(x, dgamma(x, shape=90, scale=0.7/90), lty=1)
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1)
line(x, dgamma(x, shape=0.9, scale=0.7/0.9))
lines(x, dgamma(x, shape=0.9, scale=0.7/0.9))
lines(x, dgamma(x, shape=0.1, scale=0.7/0.1))
lines(x, dgamma(x, shape=0.4, scale=0.7/0.4))
lines(x, dgamma(x, shape=0.7, scale=0.7/0.7))
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1)
lines(x, dgamma(x, shape=0.7, scale=0.7/0.7))
lines(x, dgamma(x, shape=0.6, scale=0.7/0.6))
lines(x, dgamma(x, shape=0.6, scale=0.7/0.5))
lines(x, dgamma(x, shape=0.8, scale=0.7/0.8))
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1)
lines(x, dgamma(x, shape=0.8, scale=0.7/0.8))
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=2, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=2, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=3, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=5, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=5, col="#317EC2")
lines(x, dgamma(x, shape=0.8, scale=0.7/0.8), lwd=5, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=5, col="#317EC2")
lines(x, dgamma(x, shape=0.7, scale=0.7/0.7), lwd=5, col="#C03830")
lines(x, dgamma(x, shape=0.6, scale=0.7/0.6), lwd=5, col="#C03830")
lines(x, dgamma(x, shape=0.5, scale=0.7/0.5), lwd=5, col="#C03830")
lines(x, dgamma(x, shape=0.4, scale=0.7/0.4), lwd=5, col="#C03830")
plot(x, dgamma(x, shape=90, scale=0.7/90),type = "l", lty=1, lwd=5, col="#317EC2")
lines(x, dgamma(x, shape=0.5, scale=0.7/0.5), lwd=5, col="#C03830")
mean(c(106, 100, 105, 101, 115, 101)/4)
42/5
42*.6
42*.8
2.72/15.17
11.761*1.16
mean(log(10^6, 10^3))
exp(mean(log(10^6, 10^3)))
exp(mean(log(10^6, 10^3)))
mean(10^6, 10^3)
log(10^6, 10^3)
c(log(10^6), log(10^3))
mean(c(log(10^6), log(10^3)))
exp(mean(c(log(10^6), log(10^3))))
getwd
getwd()
setwd("./GitHub/THEE_2024reproducibility/")
buggy_sites <- c("html1", "html2", "html3")
?runif
runif(1, min=1, max=length(buggy_sites))
?sample.int
sample.int(buggy_sites)
?sample
sample(buggy_sites)
sample(buggy_sites, size=1)
sample(buggy_sites, size=1)
sample(buggy_sites, size=1)
sample(buggy_sites, size=1)
sample(buggy_sites, size=1)
sample(buggy_sites, size=1)
0*25
0*25 + 1
1*25 + 1
0.4*24 + 1
0.5*24 + 1
0.1*24 + 1
results <- 12
print(results
3 - 1:10
5:-5
# simple function to multiply integers from 1 to 10 by parameter value ("multiplier")
get.multiples1to10 <- function(multiplier){
numbers <- 1:10
return(multiplier*numbers)
}
# display results for parameter value set to 3
current_value <- 3
results < get.multiples1to10(multiplier = current_value)
print(results)
25/7
library(usethis)
??usethis
getpwd
getwd
getwd)
getwd()
usethis::use_course(
repo_spec = "spcanelon/RLadies-xaringan-template",
destdir = "./test_deck"
)
?use_course
usethis::use_course(
url = "https://spcanelon.github.io/RLadies-xaringan-template/#1",
destdir = "./test_deck"
)
usethis::use_course(
url = "https://spcanelon.github.io/RLadies-xaringan-template/#1",
destdir = "./test_deck"
)
install.packages("xaringan")
library(Rtools)
install.packages("Rtools")
install.packages("Rtools44")
library(Rtools44)
library(xaringan)
library(xaringan)
??xaringan
xaringan::moon_reader()
